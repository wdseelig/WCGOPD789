(function(e){var f={},l,g,p=1,h,m=this,n,j=m.postMessage,i,d;if(!j)var k=[],o,q=function(){o=setInterval(function(){if(0<k.length)i.location=d.replace(/#.*$/,"")+"#"+ +new Date+p++ +"&"+k.shift()},1E3)};e.postMessage=function(c,a,b){if(d=a)if(c="string"===typeof c?c:e.param(c),i=b||parent,j)i.postMessage(c,d.replace(/([^:]+:\/\/[^\/]+).*/,"$1"));else if(d){c=c.match(/.{1,1000}/g);a=0;for(b="";b=c[a++];)k.push(b+"&;;pm_part="+a+","+c.length);"undefined"===typeof o&&q(i,d)}};e.receiveMessage=n=function(c,a,b){b=a&&e.isWindow(a)?a:b&&e.isWindow(b)?b:m;if(j)if(c&&(h&&n(),h=function(b){if("string"===typeof a&&b.origin!==a||e.isFunction(a)&&!1===a(b.origin))return!1;c(b)}),b.addEventListener)b[c?"addEventListener":"removeEventListener"]("message",h,!1);else b[c?"attachEvent":"detachEvent"]("onmessage",h);else{for(var d in f)f[d]===b&&clearInterval(d)&&(f[d]=null);c&&(delay="number"===typeof a?a:"number"===typeof delay?delay:100,d=setInterval(function(){var a=b.document.location.hash,d=/^#?\d+&/;if(a!==l&&d.test(a)&&(l=a,a=a.match(/(.*)&;;pm_part=(\d+),(\d+)/),g+=a[1].replace(d,""),a[2]===a[3]))c({data:g}),g="",b.document.location.hash=""},100),f[d]=b)}}})(jQuery);
